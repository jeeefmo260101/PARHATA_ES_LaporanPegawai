<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Pegawai dengan Filter Lanjutan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* bg-gray-900 */
            color: #d1d5db; /* text-gray-300 */
        }
        .filter-section {
            background-color: #1f2937; /* bg-gray-800 */
            border-radius: 0.5rem;
            padding: 1.5rem;
            border: 1px solid #374151; /* border-gray-700 */
        }
        .table-container {
            background-color: #1f2937; /* bg-gray-800 */
            border-radius: 0.5rem;
            padding: 1.5rem;
            border: 1px solid #374151; /* border-gray-700 */
        }
        thead th {
            background-color: #374151; /* bg-gray-700 */
        }
        select, input[type="text"], input[type="search"] {
            background-color: #374151; /* bg-gray-700 */
            border-color: #4b5563; /* border-gray-600 */
            color: #d1d5db; /* text-gray-300 */
        }
        select:focus, input:focus {
            outline: none;
            border-color: #3b82f6; /* border-blue-500 */
            box-shadow: 0 0 0 2px #1e40af; /* ring-blue-500 */
        }
        .btn-primary {
            background-color: #3b82f6; /* bg-blue-600 */
            color: white;
            transition: background-color 0.2s;
        }
        .btn-primary:hover {
            background-color: #2563eb; /* bg-blue-700 */
        }
        .btn-secondary {
            background-color: #4b5563; /* bg-gray-600 */
            color: white;
            transition: background-color 0.2s;
        }
        .btn-secondary:hover {
            background-color: #6b7280; /* bg-gray-500 */
        }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8">

    <div class="max-w-full mx-auto">
        <h1 class="text-2xl sm:text-3xl font-bold text-white mb-6">Laporan Pegawai</h1>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Kolom Filter -->
            <div class="lg:col-span-1">
                <div class="filter-section space-y-6 sticky top-6">
                    <h2 class="text-xl font-semibold text-white">Filter Pencarian</h2>

                    <!-- Filter Zonasi -->
                    <div>
                        <label for="zonasi" class="block text-sm font-medium mb-1">Zonasi</label>
                        <select id="zonasi" class="w-full p-2 rounded-md text-sm">
                            <option value="">Semua Zonasi</option>
                            <option value="Medan Raya">Medan Raya</option>
                            <option value="Baru">Baru</option>
                            <option value="Perjuangan">Perjuangan</option>
                        </select>
                    </div>

                    <!-- Filter Tipe Satker -->
                    <div>
                        <label class="block text-sm font-medium mb-2">Tipe Satker</label>
                        <div class="flex items-center space-x-4">
                            <label class="flex items-center"><input type="checkbox" class="h-4 w-4 rounded" value="Kota"> <span class="ml-2">Kota</span></label>
                            <label class="flex items-center"><input type="checkbox" class="h-4 w-4 rounded" value="Kabupaten"> <span class="ml-2">Kabupaten</span></label>
                        </div>
                    </div>

                    <!-- Filter Golongan -->
                    <div>
                        <label for="golongan" class="block text-sm font-medium mb-1">Golongan</label>
                        <select id="golongan" class="w-full p-2 rounded-md text-sm">
                            <option value="">Semua Golongan</option>
                            <option value="III/d">III/d</option>
                            <option value="IV/a">IV/a</option>
                            <option value="IV/b">IV/b</option>
                            <option value="III/b">III/b</option>
                        </select>
                    </div>

                    <!-- Filter Kinerja -->
                    <div>
                        <label for="kinerja" class="block text-sm font-medium mb-1">Pencapaian Kinerja</label>
                        <select id="kinerja" class="w-full p-2 rounded-md text-sm">
                            <option value="">Semua</option>
                            <option value="PPK">PPK</option>
                            <option value="Bendahara">Bendahara</option>
                            <option value="PPSPM">PPSPM</option>
                            <option value="PBJ">PBJ</option>
                        </select>
                    </div>
                    
                    <!-- Filter Gender -->
                    <div>
                        <label for="gender" class="block text-sm font-medium mb-1">Gender</label>
                        <select id="gender" class="w-full p-2 rounded-md text-sm">
                            <option value="">Semua Gender</option>
                            <option value="Pria">Pria</option>
                            <option value="Wanita">Wanita</option>
                        </select>
                    </div>

                    <!-- Filter Masa Kerja -->
                    <div>
                        <label for="masaKerja" class="block text-sm font-medium mb-1">Masa Kerja</label>
                        <select id="masaKerja" class="w-full p-2 rounded-md text-sm">
                            <option value="">Semua</option>
                            <option value="0-2">&lt; 2 tahun</option>
                            <option value="2-5">2 - 5 tahun</option>
                            <option value="5-8">5 - 8 tahun</option>
                            <option value="8-10">8 - 10 tahun</option>
                        </select>
                    </div>

                    <!-- Filter Kelompok Jabatan -->
                    <div>
                        <label for="kelompokJabatan" class="block text-sm font-medium mb-1">Kelompok Jabatan</label>
                        <select id="kelompokJabatan" class="w-full p-2 rounded-md text-sm">
                            <option value="">Semua</option>
                            <option value="Pengawas">Pengawas</option>
                            <option value="Administrator">Administrator</option>
                            <option value="Fungsional Ahli Muda">Fungsional Ahli Muda</option>
                            <option value="Fungsional Ahli Madya">Fungsional Ahli Madya</option>
                        </select>
                    </div>

                    <!-- Tombol Aksi -->
                    <div class="flex flex-col sm:flex-row gap-3 pt-4">
                        <button id="applyFilter" class="btn-primary w-full sm:w-auto flex-1 font-semibold py-2 px-4 rounded-md">Terapkan Filter</button>
                        <button id="resetFilter" class="btn-secondary w-full sm:w-auto flex-1 font-semibold py-2 px-4 rounded-md">Reset</button>
                    </div>
                </div>
            </div>

            <!-- Kolom Tabel -->
            <div class="lg:col-span-3">
                <div class="table-container">
                    <div class="flex justify-end mb-4">
                        <input type="search" id="search" placeholder="Cari nama atau NIP..." class="w-full sm:w-64 p-2 rounded-md text-sm">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-600">
                            <thead class="">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Nama</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">NIP Baru</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Jabatan</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Satker</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Golongan</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Status</th>
                                </tr>
                            </thead>
                            <tbody id="employeeTableBody" class="divide-y divide-gray-700">
                                <!-- Data pegawai akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <div id="noResults" class="text-center py-8 text-gray-400 hidden">
                        <p>Tidak ada data yang cocok dengan filter yang diterapkan.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA PEGAWAI (MOCK DATA) ---
        // Data ini mensimulasikan data yang akan Anda dapatkan dari database.
        const allEmployees = [
            { nama: 'Ratnauli Naibaho, SE, M.Si', nip: '196901281992122001', jabatan: 'Kepala BPS Kabupaten/Kota', satker: 'BPS KABUPATEN KARO', golongan: 'IV/b', status: 'PNS', gender: 'Wanita', masaKerja: 9, kinerja: 'PPK', kelompokJabatan: 'Administrator' },
            { nama: 'Ahmad Rivani, S.Pt', nip: '197905052005021005', jabatan: 'Kepala Subbagian Umum', satker: 'BPS KOTA TEBING TINGGI', golongan: 'III/d', status: 'PNS', gender: 'Pria', masaKerja: 7, kinerja: 'PPSPM', kelompokJabatan: 'Pengawas' },
            { nama: 'Marine Sohadi Angkat, S.Si, M.Si', nip: '197301051994121001', jabatan: 'Kepala BPS Kabupaten/Kota', satker: 'BPS KABUPATEN SERDANG BEDAGAI', golongan: 'IV/b', status: 'PNS', gender: 'Pria', masaKerja: 10, kinerja: 'Bendahara', kelompokJabatan: 'Administrator' },
            { nama: 'Royana Simanjuntak, S.E.', nip: '198403272006042018', jabatan: 'Kepala Subbagian Umum', satker: 'BPS KABUPATEN LABUHAN BATU SELATAN', golongan: 'III/b', status: 'PNS', gender: 'Wanita', masaKerja: 6, kinerja: 'PBJ', kelompokJabatan: 'Pengawas' },
            { nama: 'Devitanorani Saragih, SST, M.Stat', nip: '198209012006022001', jabatan: 'Kepala BPS Kabupaten/Kota', satker: 'BPS KABUPATEN SAMOSIR', golongan: 'IV/a', status: 'PNS', gender: 'Wanita', masaKerja: 8, kinerja: 'PPK', kelompokJabatan: 'Administrator' },
            { nama: 'Rahmat Gustiar, S.Si, M.Si', nip: '197308101994011001', jabatan: 'Kepala Bagian Umum', satker: 'BPS PROVINSI SUMATERA UTARA', golongan: 'IV/b', status: 'PNS', gender: 'Pria', masaKerja: 9, kinerja: 'PPSPM', kelompokJabatan: 'Administrator' },
            { nama: 'Budi Santoso, S.Kom', nip: '199501102022031001', jabatan: 'Pranata Komputer Ahli Muda', satker: 'BPS KOTA MEDAN', golongan: 'III/d', status: 'PNS', gender: 'Pria', masaKerja: 1, kinerja: 'PBJ', kelompokJabatan: 'Fungsional Ahli Muda' },
            { nama: 'Citra Lestari, S.Stat', nip: '199005202015032004', jabatan: 'Statistisi Ahli Madya', satker: 'BPS PROVINSI SUMATERA UTARA', golongan: 'IV/a', status: 'PNS', gender: 'Wanita', masaKerja: 4, kinerja: 'PPK', kelompokJabatan: 'Fungsional Ahli Madya' },
            { nama: 'Dedi Irawan, SE.Ak', nip: '198802152010121002', jabatan: 'Auditor Ahli Muda', satker: 'BPS KOTA BINJAI', golongan: 'III/d', status: 'PNS', gender: 'Pria', masaKerja: 5, kinerja: 'Bendahara', kelompokJabatan: 'Fungsional Ahli Muda' },
            { nama: 'Eka Putri, S.Sos', nip: '199808172023012001', jabatan: 'Analis SDM Aparatur', satker: 'BPS KABUPATEN LANGKAT', golongan: 'III/b', status: 'PNS', gender: 'Wanita', masaKerja: 1, kinerja: 'N/A', kelompokJabatan: 'Fungsional Ahli Muda' },
        ];

        // --- DEFINISI ZONASI ---
        // Definisikan Satker mana saja yang masuk ke dalam zonasi tertentu.
        const zonasiMapping = {
            "Medan Raya": ["BPS KOTA MEDAN", "BPS PROVINSI SUMATERA UTARA"],
            "Baru": ["BPS KOTA BINJAI", "BPS KABUPATEN DELI SERDANG", "BPS KABUPATEN SERDANG BEDAGAI"],
            "Perjuangan": ["BPS KABUPATEN LANGKAT", "BPS KOTA TEBING TINGGI", "BPS KABUPATEN KARO", "BPS KABUPATEN SAMOSIR", "BPS KABUPATEN LABUHAN BATU SELATAN"]
        };

        // --- FUNGSI UTAMA ---
        document.addEventListener('DOMContentLoaded', function () {
            const tableBody = document.getElementById('employeeTableBody');
            const noResultsDiv = document.getElementById('noResults');
            const applyFilterBtn = document.getElementById('applyFilter');
            const resetFilterBtn = document.getElementById('resetFilter');
            const searchInput = document.getElementById('search');

            // Fungsi untuk merender tabel
            function renderTable(data) {
                tableBody.innerHTML = '';
                if (data.length === 0) {
                    noResultsDiv.classList.remove('hidden');
                    tableBody.classList.add('hidden');
                } else {
                    noResultsDiv.classList.add('hidden');
                    tableBody.classList.remove('hidden');
                    data.forEach(emp => {
                        const row = `
                            <tr class="hover:bg-gray-800">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-white">${emp.nama}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">${emp.nip}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">${emp.jabatan}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">${emp.satker}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">${emp.golongan}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm">${emp.status}</td>
                            </tr>
                        `;
                        tableBody.innerHTML += row;
                    });
                }
            }

            // Fungsi untuk menerapkan semua filter
            function applyFilters() {
                // Mengambil nilai dari setiap filter
                const zonasiFilter = document.getElementById('zonasi').value;
                const satkerTipeCheckboxes = document.querySelectorAll('input[type="checkbox"]:checked');
                const golonganFilter = document.getElementById('golongan').value;
                const kinerjaFilter = document.getElementById('kinerja').value;
                const genderFilter = document.getElementById('gender').value;
                const masaKerjaFilter = document.getElementById('masaKerja').value;
                const kelompokJabatanFilter = document.getElementById('kelompokJabatan').value;
                const searchQuery = searchInput.value.toLowerCase();

                let filteredData = allEmployees;

                // 1. Filter by Zonasi
                if (zonasiFilter) {
                    const satkersInZone = zonasiMapping[zonasiFilter] || [];
                    filteredData = filteredData.filter(emp => satkersInZone.includes(emp.satker));
                }
                
                // 2. Filter by Tipe Satker (Kota/Kabupaten)
                if (satkerTipeCheckboxes.length > 0) {
                    const selectedTipes = Array.from(satkerTipeCheckboxes).map(cb => cb.value.toLowerCase());
                    filteredData = filteredData.filter(emp => {
                        return selectedTipes.some(tipe => emp.satker.toLowerCase().includes(tipe));
                    });
                }

                // 3. Filter by Golongan
                if (golonganFilter) {
                    filteredData = filteredData.filter(emp => emp.golongan === golonganFilter);
                }

                // 4. Filter by Kinerja
                if (kinerjaFilter) {
                    filteredData = filteredData.filter(emp => emp.kinerja === kinerjaFilter);
                }

                // 5. Filter by Gender
                if (genderFilter) {
                    filteredData = filteredData.filter(emp => emp.gender === genderFilter);
                }

                // 6. Filter by Masa Kerja
                if (masaKerjaFilter) {
                    const [min, max] = masaKerjaFilter.split('-').map(Number);
                    filteredData = filteredData.filter(emp => {
                        if (max) { // Range
                           return emp.masaKerja >= min && emp.masaKerja <= max;
                        } else { // Single value (e.g., < 2)
                           return emp.masaKerja < min;
                        }
                    });
                }
                
                // 7. Filter by Kelompok Jabatan
                if (kelompokJabatanFilter) {
                    filteredData = filteredData.filter(emp => emp.kelompokJabatan === kelompokJabatanFilter);
                }

                // 8. Filter by Search Query (Nama atau NIP)
                if (searchQuery) {
                    filteredData = filteredData.filter(emp => 
                        emp.nama.toLowerCase().includes(searchQuery) || 
                        emp.nip.includes(searchQuery)
                    );
                }

                renderTable(filteredData);
            }

            // Fungsi untuk mereset semua filter
            function resetFilters() {
                document.getElementById('zonasi').value = '';
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                document.getElementById('golongan').value = '';
                document.getElementById('kinerja').value = '';
                document.getElementById('gender').value = '';
                document.getElementById('masaKerja').value = '';
                document.getElementById('kelompokJabatan').value = '';
                searchInput.value = '';
                renderTable(allEmployees);
            }

            // Event Listeners
            applyFilterBtn.addEventListener('click', applyFilters);
            resetFilterBtn.addEventListener('click', resetFilters);
            searchInput.addEventListener('input', applyFilters); // Real-time search

            // Render tabel awal saat halaman dimuat
            renderTable(allEmployees);
        });
    </script>

</body>
</html>
